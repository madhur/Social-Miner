<script type="text/javascript" src="src/prototype.js"></script>

<script type="text/javascript">
var session = null;
if(localStorage.session)
{
  session = JSON.parse(localStorage.session);
}

chrome.extension.onRequest.addListener(
  function(request, sender, sendResponse) {
    if(!request.message)
      return;

    switch(request.message)
    {
      case "setSession":
      {
	if(request.session == null)
	{
	  localStorage.session = null;
	  session = null;
	  sendResponse();
	  break;
	}

	localStorage.session = JSON.stringify(request.session);
	session = request.session;
	sendResponse();
	break;
      }
      case "getSession":
      {
	sendResponse(session);
	break;
      }
    }
  });
</script>
